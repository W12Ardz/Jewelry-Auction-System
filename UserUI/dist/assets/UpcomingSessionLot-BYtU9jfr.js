import{r as o,b as F,j as e,c as G,F as $,u as Y,d as _,e as q,C as f,M as c,f as z,Q as X,h as Z,i as ee,k as se,B as T}from"./index-Bvu6Xm-K.js";import{c as te}from"./InputGroupContext-D0hYuEwK.js";const h=o.forwardRef(({className:r,bsPrefix:s,as:l="span",...n},d)=>(s=F(s,"input-group-text"),e.jsx(l,{ref:d,className:G(r,s),...n})));h.displayName="InputGroupText";const re=r=>e.jsx(h,{children:e.jsx($,{type:"checkbox",...r})}),ae=r=>e.jsx(h,{children:e.jsx($,{type:"radio",...r})}),L=o.forwardRef(({bsPrefix:r,size:s,hasValidation:l,className:n,as:d="div",...i},p)=>{r=F(r,"input-group");const u=o.useMemo(()=>({}),[]);return e.jsx(te.Provider,{value:u,children:e.jsx(d,{ref:p,...i,className:G(n,r,s&&`${r}-${s}`,l&&"has-validation")})})});L.displayName="InputGroup";const oe=Object.assign(L,{Text:h,Radio:ae,Checkbox:re}),ie=()=>{var S,C,k,P,R,w,M,E;const{lotId:r}=Y(),[s,l]=o.useState({}),n=JSON.parse(localStorage.getItem("account")),[d,i]=o.useState(!1),[p,u]=o.useState(!1),[x,U]=o.useState(null),N=_(),[D,j]=o.useState(!1),[g,H]=o.useState(""),[m,v]=o.useState(null),[O,b]=o.useState(!1),y=[];let B=n?n.memberId:0;o.useEffect(()=>{(async()=>{try{const t=await Z(r);l(t)}catch(t){console.log(t)}})()},[r]);for(let a=0;a<=s.maxStep;a++)y.push(s.startPrice+s.pricePerStep*a);o.useEffect(()=>{(async()=>{try{const t=await ee(B,r);t.status==="REGISTERED"?(U(t.previousPrice),u(!0)):u(!1)}catch(t){console.log(t)}})()},[B,r]);const W=()=>{i(!1),j(!1)},A=()=>{b(!1),j(!1)},J=()=>{b(!1),i(!0)},K=()=>{n===null?(alert("Please login before register to bid"),N("/login",{state:{from:`/upcoming-session-lot/${r}`}})):i(!0)},Q=()=>{j(!0),b(!0),i(!1)},I=async a=>{a.preventDefault();try{if(g.trim()===""){v("Please choose a price to bid");return}else{const t=await se(n.memberId,r,g);t.message?(T.error("Failed to register to bid"),v(t.message)):(u(!0),T.success("Register to bid successfully"),setTimeout(()=>{window.location.reload()},2e3),console.log(t))}}catch(t){console.log(t.response)}},V=()=>{N(-1)};return e.jsxs("div",{className:"container",children:[e.jsx("div",{className:"",children:e.jsxs("button",{onClick:V,className:"btn",children:[e.jsx(q,{})," BACK TO AUCTION"]})}),e.jsx("hr",{}),e.jsxs("div",{className:"row",children:[e.jsx("div",{className:"col-md-5",children:e.jsx(f,{children:((S=s.product)==null?void 0:S.productImages)&&((C=s.product)==null?void 0:C.productImages.map((a,t)=>e.jsxs(f.Item,{children:[e.jsx("img",{className:"d-block w-100 h-50",src:a.imageUrl,alt:a.defaultImage}),e.jsx(f.Caption,{})]},t),[]))})}),e.jsxs("div",{className:"ms-3 col-md-6",children:[e.jsx("h4",{children:(k=s.product)==null?void 0:k.name}),e.jsx("p",{children:(P=s.product)==null?void 0:P.description}),e.jsxs("p",{className:"secondary",children:["Estimate Price: $",(R=s.product)==null?void 0:R.estimatePriceMin," - $",(w=s.product)==null?void 0:w.estimatePriceMax]}),e.jsxs("p",{className:"secondary",children:["Current Start Price: $",s.currentPrice]}),e.jsxs("p",{className:"secondary",children:["Category: ",(E=(M=s.product)==null?void 0:M.category)==null?void 0:E.name.toUpperCase()]}),p?e.jsxs("div",{className:"mt-3",children:[(x===0||x)&&e.jsxs("p",{className:!0,children:["You have placed a bid:",e.jsxs("strong",{style:{color:"red"},children:[" $",x]})]}),e.jsx("button",{className:"registered-btn",children:"REGISTERED"})]}):e.jsx("div",{className:"mt-3",children:e.jsx("button",{className:"register-to-bid-btn",onClick:K,children:"Register To Bid"})}),e.jsxs(c,{show:d,onHide:W,centered:!0,children:[e.jsx(c.Header,{closeButton:!0,children:e.jsx(c.Title,{children:"Register to Bid"})}),e.jsx(c.Body,{children:e.jsx("h5",{children:"Would you like to set a price in advance?"})}),e.jsxs(c.Footer,{children:[e.jsx("button",{className:"register-to-bid-no-btn",onClick:I,children:"Register without place bid"}),e.jsx("button",{className:"register-to-bid-yes-btn",onClick:Q,children:"Place a bid"})]})]}),e.jsxs(c,{show:O,onHide:A,centered:!0,children:[e.jsx(c.Header,{closeButton:!0,children:e.jsx(c.Title,{children:"Register to Bid"})}),e.jsx(c.Body,{children:e.jsx("h5",{children:"Would you like to set a price in advance?"})}),D?e.jsxs(e.Fragment,{children:[e.jsxs(oe,{className:"mb-3 custom-input-group",size:"sm",children:[e.jsxs(z.Select,{name:"price",value:g,onChange:a=>H(a.target.value),children:[e.jsx("option",{value:"",children:"--"}),y.map((a,t)=>e.jsx("option",{value:a,children:a},t))]}),e.jsx("button",{className:"custom-btn",onClick:I,children:"Submit"})]}),e.jsx("div",{className:"ms-3",children:m&&e.jsx("p",{className:"text-danger",children:m})})]}):e.jsx(e.Fragment,{children:e.jsx("div",{className:"ms-3",children:m&&e.jsx("p",{className:"text-danger",children:m})})}),e.jsx(c.Footer,{children:e.jsx("button",{className:"register-to-bid-no-btn",onClick:J,children:"Back"})})]})]}),e.jsx(X,{})]})]})};export{ie as default};
